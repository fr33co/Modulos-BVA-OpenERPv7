<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data>

<!--
SECUENCIA
-->

        <record id="seq_type_proyectos" model="ir.sequence.type">
            <field name="name">Proyectos</field>
            <field name="code">gdc.proyectos</field>
        </record>
        <record id="seq_proyectos" model="ir.sequence">
            <field name="name">Repair Order</field>
            <field name="code">gdc.proyectos</field>
            <field name="prefix">GDC</field>
            <field name="padding">6</field>
        </record>

<!--
SECTOR
-->

        <record model="ir.actions.act_window" id="sector_list_action">
            <field name="name">Sectores</field>
            <field name="res_model">gdc.sector</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
            <p class="oe_view_nocontent_create">Crear sectores</p>
            </field>
        </record>
        
        <record model="ir.ui.view" id="sector_view_form">
            <field name="name">gdc.sector.form</field>
            <field name="model">gdc.sector</field>
            <field name="type">form</field>
            <field name="priority" eval="16"/>
            <field name="arch" type="xml">
                <form string="Sector">
                    <field name="name_sector" />
                </form>
            </field>
        </record>

<!--
PROYECTOS
-->

        <record model="ir.actions.act_window" id="proyectos_list_action">
            <field name="name">Proyectos</field>
            <field name="res_model">gdc.proyectos</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,gantt</field>
            <field name="help" type="html">
            </field>
        </record>
        
        <record model="ir.ui.view" id="proyectos_tree_view">
            <field name="name">gdc.proyectos.tree</field>
            <field name="model">gdc.proyectos</field>
            <field name="arch" type="xml">
                <tree string="Proyectos" colors="red:estado in ('Propuesto', 'Vencido');blue:estado in ('Planificacion', 'Progreso');green:estado=='Terminado';gray:estado in ('Archivado', 'Plantilla');orange:estado=='Congelado'">
                    <field name="date_created" />
                    <field name="codigo" />
                    <field name="actividad" />
                    <field name="supervisor_id"/>
                    <field domain="[('domain','=','responsible_id')]" name="responsible_id"/>
                    <field name="cobertura" />
                    <field name="address_id" />
                    <field name="priority"/>
                    <field name="date_start"/>
                    <field name="date_end"/>
                    <field name="estado"/>
                    <field name="progreso"/>
                    <field name="dias_proyecto"/>
                </tree>
            </field>
        </record>
        
        <record model="ir.ui.view" id="proyectos_view_form">
            <field name="name">gdc.proyectos.form</field>
            <field name="model">gdc.proyectos</field>
            <field name="type">form</field>
            <field name="priority" eval="16"/>
            <field name="arch" type="xml">
                <form string="Asignacion" version="7.0">
                    <group>
                        <group>
                            <field name="actividad" string="Actividad"/>
                             <field name="cobertura"/>
                        </group>
                        <group>
                            <field name="date_created" readonly="1"/>
                            <field name="codigo" readonly="1"/>
                        </group>
                        <group>
                            <field name="supervisor_id" domain="[('category_id.name','ilike','Supervisor')]"/>
                            <field name="responsible_id" domain="[('category_id.name','ilike','Responsable')]"/>
                            <field name="priority"/>
                            <field name="presu_tentativo"/>
                            <field name="presu_real"/>
                        </group>
                        <group>
                            <field name="date_start" on_change="onchange_date_start(date_start)"/>
                            <field name="date_end" on_change="onchange_date_end(date_end)"/>
                            <field name="dias_proyecto" readonly="1"/>
                            <field name="estado"/>
                            <field name="progreso" readonly="1" widget="progressbar"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Descripcion">
                            <field name="description" placeholder="Agregar descripcion..."/>
                        </page>
                        <page string="Destino y Cantidad de Beneficiados">
                            <group>
                                <group>
                                    <label for="address_id" string="Lugar"/>
                                       <div>
                                           <field name="address_id" on_change="on_change_address_id(address_id)" domain="[('category_id.name','ilike','Lugar')]"/>
                                           <field name="street" placeholder="Direccion..."/>
                                           <field name="street2" placeholder="Cont. Direccion..."/>
                                           <div class="address_format">
                                               <field name="city" placeholder="Ciudad" style="width: 40%%"/>
                                               <field name="state_id" class="oe_no_button" placeholder="Estado" style="width: 37%%" options='{"no_open": true}'/>
                                               <field name="zip" placeholder="Codigo Postal" style="width: 20%%"/>
                                           </div>    
                                           <field name="country_id" placeholder="Pais" class="oe_no_button" options='{"no_open": true}'/>
                                       </div>
                                </group>
                                <group>
                                    <field name="bene_tentativo"/>
                                </group>
                            </group>
                        </page>
                        <page string="Entes ejecutantes asignados" name="team">
                            <group>
                                <field colspan="4" name="members_project" widget="many2many_kanban">
                                    <kanban quick_create="false" create="true" delete="true">
                                        <field name="name"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div style="position: relative">
                                                    <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                                    <div class="oe_module_vignette">
                                                        <div class="oe_module_desc">
                                                            <field name="name"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                </field>
                            </group>
                        </page>
                        <page string="Tareas">
                            <field name="tareas_ids" nolabel="1" colspan="4" mode="tree">
                                <tree string="Tareas">
                                    <field name="name_tarea" />
                                    <field name="date_start_tarea"/>
                                    <field name="date_end_tarea"/>
                                    <field name="progreso_tarea"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Incidencias">
                            <field name="incidencias"/>
                        </page>
                        <page string="Conclusiones">
                            <field name="conclusiones"/>
                        </page>
                        <page string="Acuerdos">
                            <field name="acuerdos"/>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="view_proyectos_gantt" model="ir.ui.view">
            <field name="name">gdc.proyectos.gantt</field>
            <field name="model">gdc.proyectos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <gantt date_start="date_start" date_stop="date_end" string="Tasks">
                </gantt>
            </field>
        </record>

        <record id="view_proyectos_calendar" model="ir.ui.view">
            <field name="name">gdc.proyectos.calendar</field>
            <field name="model">gdc.proyectos</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <calendar color="actividad" date_start="date_start" date_stop="date_end" string="Actividades">
                    <field name="actividad"/>
                </calendar>
            </field>
        </record>

<!--
TAREAS
-->

        <record model="ir.actions.act_window" id="tareas_list_action">
            <field name="name">Tareas</field>
            <field name="res_model">gdc.tareas</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,gantt</field>
            <field name="help" type="html">
            </field>
        </record>

        <record model="ir.ui.view" id="tareas_tree_view">
            <field name="name">gdc.tareas.tree</field>
            <field name="model">gdc.tareas</field>
            <field name="arch" type="xml">
                <tree string="Tareas">
                    <field name="project_id2" />
                    <field name="name_tarea" />
                    <field name="responsible_id" />
                    <field name="date_start_tarea"/>
                    <field name="date_end_tarea"/>
                    <field name="dias_tarea" />
                    <field name="progreso_tarea" />
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="tareas_form_view">
            <field name="name">gdc.tareas.form</field>
            <field name="model">gdc.tareas</field>
            <field name="arch" type="xml">
                <form string="Tareas" version="7.0">
                    <group>
                        <group>
                            <field name="project_id2" />
                            <field name="name_tarea" />
                            <field name="responsible_id" />
                            <field name="date_start_tarea" on_change="onchange_date_start_tarea(date_start_tarea)"/>
                            <field name="date_end_tarea" on_change="onchange_date_end_tarea(date_end_tarea)"/>
                        </group>
                        <group>
                            <field name="estado_tarea" />
                            <field name="dias_tarea" />
                            <field name="progreso_tarea" />
                        </group>
                        <group>
                            <button name="compute_progress_days" type="object" string="Comenzar la tarea" />
                            <button name="compute_progress_days" type="object" string="Finalizar la tarea" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Descripcion">
                            <field name="description" placeholder="Agregar descripcion..."/>
                        </page>
                        <page string="Entes ejecutantes asignados" name="team">
                            <group>
                                <field colspan="4" name="members_tareas" widget="many2many_kanban">
                                    <kanban quick_create="false" create="true" delete="true">
                                        <field name="name"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div style="position: relative">
                                                    <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                                    <div class="oe_module_vignette">
                                                        <div class="oe_module_desc">
                                                            <field name="name"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                </field>
                            </group>
                        </page>
                        <page string="Subida de informe">
                            <field name="informe_tareas"/>
                        </page>
                        <page string="Subida de imagenes">
                            <field name="image" widget='image'/>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="view_tareas_gantt" model="ir.ui.view">
            <field name="name">gdc.tareas.gantt</field>
            <field name="model">gdc.tareas</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <gantt date_start="date_start_tarea" date_stop="date_end_tarea" string="Tareas">
                </gantt>
            </field>
        </record>

        <record id="view_tareas_calendar" model="ir.ui.view">
            <field name="name">gdc.tareas.calendar</field>
            <field name="model">gdc.tareas</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <calendar color="name_tarea" date_start="date_start_tarea" date_stop="date_end_tarea" string="Tareas">
                    <field name="name_tarea"/>
                </calendar>
            </field>
        </record>

        <menuitem id="main_gobiernodecalle_menu" name="Gobierno de calle y Direccionalidad" sequence="120"/>

        <menuitem id="proyectos_menu" name="Actividades" parent="main_gobiernodecalle_menu" sequence="10"/>
        <menuitem id="asigancion_menu" name="Asignacion" parent="proyectos_menu" action="proyectos_list_action" sequence="1"/>
        <menuitem id="tareas_menu" name="Tareas" parent="proyectos_menu" action="tareas_list_action" sequence="3"/>
        
    </data>
</openerp>
